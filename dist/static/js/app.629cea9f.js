(function(e){function t(t){for(var a,r,o=t[0],l=t[1],d=t[2],p=0,u=[];p<o.length;p++)r=o[p],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(t);while(u.length)u.shift()();return s.push.apply(s,d||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,o=1;o<n.length;o++){var l=n[o];0!==i[l]&&(a=!1)}a&&(s.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},i={app:0},s=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},4507:function(e){e.exports=JSON.parse('{"code":0,"message":"","data":{"relations":[{"id":"2730","name":"composed_of","semantic_type":"composed_of","properties":{"scenes":"allinmd","status":1,"lastModified":1618832915,"releaseDate":1618832915},"direction":0,"relation_node":{"id":"2c29f5249cf211ebbc710242c0a8c409","name":"外伤史","semantic_type":"Symptom","labels":["Concept","Symptom"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618384950,"releaseDate":1618384950}}},{"id":"2677","name":"composed_of","semantic_type":"composed_of","properties":{"scenes":"allinmd","status":1,"lastModified":1618803809,"releaseDate":1618803809},"direction":1,"relation_node":{"id":"8f2d01129c1011eb892ad31672d12132","name":"膝关节外伤及手术史","semantic_type":"Symptom","labels":["Concept","Symptom"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2649","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618885401,"releaseDate":1618885401},"direction":1,"relation_node":{"id":"8e8922369c1011eb892ad31672d12132","name":"髌骨肌腱炎","semantic_type":"BodyStructure","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2672","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618885282,"releaseDate":1618885282},"direction":1,"relation_node":{"id":"8f0c21689c1011eb892ad31672d12132","name":"膝关节脱位","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2662","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618885172,"releaseDate":1618885172},"direction":1,"relation_node":{"id":"8eec11d49c1011eb892ad31672d12132","name":"股骨髁骨折","semantic_type":"Side","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2660","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618885118,"releaseDate":1618885118},"direction":1,"relation_node":{"id":"8ed52bcc9c1011eb892ad31672d12132","name":"膝关节内侧副韧带损伤","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2636","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618884966,"releaseDate":1618884966},"direction":1,"relation_node":{"id":"8ebdb2d09c1011eb892ad31672d12132","name":"膝髌韧带裂（扭）伤","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2621","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618883252,"releaseDate":1618883252},"direction":1,"relation_node":{"id":"84417f449c1011eb892ad31672d12132","name":"剥脱性骨软骨炎","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2553","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618886711,"releaseDate":1618886711},"direction":1,"relation_node":{"id":"8ef701fc9c1011eb892ad31672d12132","name":"髌骨脱位","semantic_type":"BetterAndWorse","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2538","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618886139,"releaseDate":1618886139},"direction":1,"relation_node":{"id":"8edf38889c1011eb892ad31672d12132","name":"膝关节游离体","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2531","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618886026,"releaseDate":1618886026},"direction":1,"relation_node":{"id":"8eb96dc49c1011eb892ad31672d12132","name":"髌骨软骨软化","semantic_type":"Relieve","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2527","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618885900,"releaseDate":1618885900},"direction":1,"relation_node":{"id":"84254cac9c1011eb892ad31672d12132","name":"半月板囊肿","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2582","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618803809,"releaseDate":1618803809},"direction":1,"relation_node":{"id":"8ed7c3509c1011eb892ad31672d12132","name":"闭合型胫骨平台骨折","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2552","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618803809,"releaseDate":1618803809},"direction":1,"relation_node":{"id":"8401f0d69c1011eb892ad31672d12132","name":"半月板损伤","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"5534","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618882945,"releaseDate":1618882945},"direction":1,"relation_node":{"id":"8ee67ed69c1011eb892ad31672d12132","name":"髌骨骨折","semantic_type":"Action","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}},{"id":"2533","name":"relation","semantic_type":"relation","properties":{"scenes":"allinmd","status":1,"lastModified":1618886473,"releaseDate":1618886473},"direction":1,"relation_node":{"id":"8ee6f92e9c1011eb892ad31672d12132","name":"膝关节或韧带的脱位、劳损或扭伤","semantic_type":"Disease","labels":["Concept","Disease"],"properties":{"scenes":"allinmd","status":1,"lastModified":1618293198,"releaseDate":1618293198}}}]}}')},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("D3")],1)},s=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"d3-container"},[n("div",{staticClass:"types"},e._l(e.typeCategories,(function(t,a,i){return n("span",{key:i,style:{backgroundColor:e.typeColor[a]},on:{mouseover:function(n){return e.handleTypeMouseover(t,a)},mouseout:function(t){return e.handleTypeMouseout()}}},[e._v(" "+e._s(a)+"("+e._s(t.length)+") ")])})),0),n("div",{staticClass:"info"},[e._v(" "+e._s(e.info)+" ")]),e._m(0),n("svg")])},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"btns"},[n("span",{attrs:{id:"zoomIn"}},[e._v(" + ")]),n("span",{attrs:{id:"zoomOut"}},[e._v(" - ")]),n("span",{attrs:{id:"reset"}},[e._v(" reset ")])])}],l=(n("159b"),n("b64b"),n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("d81d"),n("a15b"),n("b0c0"),n("c740"),n("a434"),n("99af"),n("5698")),d=n("4507"),c={data:function(){return{info:"",typeCategories:{},typeColor:{},type:["Disease","Symptom","Age","Sex","BodyStructure","Check","Thing","Severity","Population","Side","BetterAndWorse","Body","Aggravate","Imaging","Relieve","Event","Base","Finding","BodyStructure_test","Action","Time"],nodes:[],links:[],visibleFlag:!1}},watch:{nodes:{handler:function(e){var t={};e.forEach((function(e){-1===Object.keys(t).indexOf(""+e.semantic_type)&&(t[e.semantic_type]=[]),t[e.semantic_type].push(e)})),this.typeCategories=t},deep:!0}},mounted:function(){this.setTypeColor(),this.initD3()},methods:{handleTypeMouseout:function(){l["k"](".single-node").style("opacity",1),l["k"](".single-line").style("opacity",1)},handleTypeMouseover:function(e){l["k"](".single-node").style("opacity",.1),l["k"](".single-line").style("opacity",.1);for(var t=0;t<e.length;t++){var n="#single-node"+e[t].id;l["k"](n).style("opacity",1)}},setTypeColor:function(){var e=this,t={};this.type.forEach((function(n){-1===Object.keys(t).indexOf(""+n)&&(t[n]=""),t[n]=e.randomColor()})),this.typeColor=t},randomColor:function(){var e=["#F4AB87","#EEC88D","#76CADF","#97DA9D","#88DCD8","#FB7F89","#F0E403","#F576BE","#ACADFF","#7EC3FB","#D0DB02","#C07B11","#00ACC2","#2AAD41","#A59D00","#EB4747","#CD0EBD","#DE3997"];return e[Math.floor(Math.random()*e.length)]},initD3:function(){var e=this,t=l["j"]("svg").attr("viewBox",[-window.innerWidth/2,-window.innerHeight/2,window.innerWidth,window.innerHeight]),n=l["l"]().on("zoom",(function(){t.attr("transform",l["n"](t.node()))}));t.call(n),l["j"]("#reset").on("click",(function(){t.call(n.transform,l["m"])})),l["j"]("#zoomIn").on("click",(function(){n.scaleBy(t,1.1)})),l["j"]("#zoomOut").on("click",(function(){n.scaleBy(t,.9)}));var a=l["f"]().force("charge",l["e"]().strength(-1e3)).force("link",l["d"]().id((function(e){return e.id})).distance(200)).force("x",l["g"]()).force("y",l["h"]()).on("tick",o),i=t.append("g").attr("class","link-container").attr("stroke","#000").attr("stroke-width",1).selectAll("line"),s=t.append("g").attr("class","link-text-container").attr("stroke","#000").attr("stroke-width",1.5).selectAll("text"),r=t.append("g").attr("class","node-container").selectAll("circle");function o(){r.attr("transform",(function(e){return"translate("+e.x+","+e.y+")"})),i.attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),s.attr("x",(function(e){return(e.source.x+e.target.x)/2})).attr("y",(function(e){return(e.source.y+e.target.y)/2}))}var c=Object.assign(t.node(),{update:function(n){var o=n.nodes,d=n.links,c=new Map(r.data().map((function(e){return[e.id,e]})));o=o.map((function(e){return Object.assign(c.get(e.id)||{},e)})),d=d.map((function(e){return Object.assign({},e)})),r=r.data(o,(function(e){return e.id})).join((function(e){return e.append("g").attr("class","single-node").attr("id",(function(e){return"single-node"+e.id}))})).call(l["b"]().on("start",v).on("drag",b).on("end",_)),l["k"](".single-node").append("circle").attr("r",30).attr("fill",p).style("cursor","pointer"),l["k"](".single-node").append("text").attr("y",0).attr("dy",5).attr("text-anchor","middle").style("cursor","pointer").attr("x",(function(e){return h(l["j"](this),e,!1)})),t.append("g").attr("class","arrow-marker").append("marker").attr("id","arrow-marker").attr("markerUnits","strokeWidth").attr("markerUnits","userSpaceOnUse").attr("viewBox","0 -5 10 10").attr("refX",40).attr("refY",0).attr("markerWidth",10).attr("markerHeight",10).attr("orient","auto").attr("stroke-width",2).append("path").attr("d","M0,-5L10,0L0,5").attr("fill","#000"),i=i.data(d,(function(e){return[e.source,e.target]})).join((function(e){return e.append("line").attr("class","single-line").attr("id",(function(e){return"single-line"+e.id})).attr("marker-end","url(#arrow-marker)")})),s=s.data(d,(function(e){return[e.source,e.target]})).join((function(e){return e.append("text").attr("class","link-text").attr("id",(function(e){return"link-text"+e.id})).text((function(e){return e.semantic_type})).attr("stroke","#000").attr("stroke-width","1").attr("fill","none").style("cursor","pointer")})),a.nodes(o),a.force("link").links(d),a.alpha(1).restart(),r.on("click",(function(t){e.visibleFlag=!e.visibleFlag,g(l["j"](this),t,e.visibleFlag)})).on("mouseover",(function(t){l["k"](".single-node").style("opacity",.2),l["k"](".single-line").style("opacity",.2),l["k"](".link-text").style("opacity",.2),l["j"]("#single-node"+t.id).style("opacity",1);var n=[];e.links.forEach((function(e){e.source!==t.id&&e.target!==t.id||n.push(e)})),n.forEach((function(e){l["j"]("#single-line"+e.id).style("opacity",1),l["j"]("#link-text"+e.id).style("opacity",1),l["j"]("#single-node"+e.source).style("opacity",1),l["j"]("#single-node"+e.target).style("opacity",1)})),e.info=JSON.stringify(t)})).on("mouseout",(function(){l["k"](".single-node").style("opacity",1),l["k"](".single-line").style("opacity",1),l["k"](".link-text").style("opacity",1),e.info=""})),i.on("mouseover",(function(t){l["k"](".single-node").style("opacity",.2),l["k"](".single-line").style("opacity",.2),l["k"](".link-text").style("opacity",.2),l["j"]("#single-line"+t.id).style("opacity",1),l["j"]("#link-text"+t.id).style("opacity",1),l["j"]("#single-node"+t.source.id).style("opacity",1),l["j"]("#single-node"+t.target.id).style("opacity",1),e.info=JSON.stringify(t)})).on("mouseout",(function(){l["k"](".single-node").style("opacity",1),l["k"](".single-line").style("opacity",1),l["k"](".link-text").style("opacity",1),e.info=""}))}});function p(t){var n=t.semantic_type;return e.typeColor[n]?e.typeColor[n]:"#ddd"}function u(t){e.$nextTick((function(){for(var n=d,a=n.data.relations,i=[],s=0;s<a.length;s++)i[s]={id:a[s].id,source:0===a[s].direction?t.id:a[s].relation_node.id,target:0===a[s].direction?a[s].relation_node.id:t.id,relation:a[s].name,name:a[s].name,properties:a[s].properties,semantic_type:a[s].semantic_type};var r=a.map((function(e){return e.relation_node}));r.forEach((function(t){e.nodes.push(t)})),e.nodes.push({id:"qwertyuiop",name:"测试无关系节点",semantic_type:"Symptom",labels:["Concept","Symptom"],properties:{scenes:"allinmd",status:1,lastModified:1618293198,releaseDate:1618293198}}),i.forEach((function(t){e.links.push(t)})),c.update({nodes:e.nodes,links:e.links})}))}function f(e){for(var t=e.length,n={},a=[],i=0;i<t;i++)n[JSON.stringify(e[i])]=!0;for(var s=Object.keys(n),r=0;r<s.length;r++)a.push(JSON.parse(s[r]));return a}function m(e){var t=[],n=[],a=[];l["k"](".single-line").each((function(i){i.source.id===e.id?a.push(i):n.push(i),i.source.id===e.id&&t.push(i.target),i.target.id===e.id&&t.push(i.source)}));var i=JSON.parse(JSON.stringify(t));i=f(i),i.forEach((function(e){var t=n.findIndex((function(t){return t.target.id===e.id||t.source.id===e.id}));t>=0&&(e.notSingle=!0)})),i.forEach((function(e){e.notSingle||l["j"]("#single-node"+e.id).remove()}));var s=[];i=i.map((function(e){e.notSingle||s.push(e)})),a.forEach((function(e){s.forEach((function(t){t.id!==e.source.id&&t.id!==e.target.id||(l["j"]("#single-line"+e.id).remove(),l["j"]("#link-text"+e.id).remove())}))})),l["j"](".menu-circle").remove()}function y(t){var n=e.nodes.findIndex((function(e){return e.id===t.id}));e.nodes.splice(n,1);var a=[],i=[],s=t.id;l["k"](".single-line").each((function(e){e.source.id===t.id||e.target.id===t.id?l["j"](this).remove():i.push(e),e.source.id===t.id&&a.push(e.target)}));var r=JSON.parse(JSON.stringify(a));r=f(r),r.forEach((function(e){var t=i.findIndex((function(t){return t.target.id===e.id||t.source.id===e.id}));t>=0&&(e.notSingle=!0)})),r.forEach((function(e){e.notSingle||l["j"]("#single-node"+e.id).remove()})),l["k"](".single-node").each((function(e){var t=e.id;t===s&&(l["j"](".menu-circle").remove(),l["j"](this).remove())})),l["k"](".link-text").each((function(e){e.source!==t&&e.target!==t||l["j"](this).remove()}))}function g(e,t,n){var a=t,i=[{population:30,value:"隐藏",type:"delete"},{population:30,value:"收起",type:"showOn"},{population:30,value:"展开",type:"showOff"}],s=l["a"]().innerRadius(80).outerRadius(35),r=l["i"]().value((function(e){return e.population})).sort(null),o=r(i),d=o.map((function(e){return(e.startAngle+e.endAngle)/2/Math.PI*180})),c=e.append("g").attr("class","menu-circle").attr("width",100).attr("height",100),p=c.append("g");p.selectAll("path").data(r(i)).enter().append("path").attr("d",s).attr("fill","#d3d7dc").style("stroke","#fff").style("cursor","pointer").on("click",(function(e){"delete"===e.data.type?y(a):"showOn"===e.data.type?m(a):u(a),l["c"].stopPropagation()})).on("mouseover",(function(){l["j"](this).style("fill","#d3d7dc").transition().style("fill","#aaaeb4")})).on("mouseout",(function(){l["j"](this).style("fill","#aaaeb4").transition().style("fill","#d3d7dc")}));var f=12,g=170*.35-.35*f,h=170*.35+.35*f,v=e.select(".menu-circle").append("g").classed("labelsvals",!0);v.append("def").append("path").attr("id","label-path-1").attr("d","m0 ".concat(-g," a").concat(g," ").concat(g," 0 1,1 -0.01 0")),v.append("def").append("path").attr("id","label-path-2").attr("d","m0 ".concat(-h," a").concat(h," ").concat(h," 0 1,0 0.01 0")),v.selectAll("text").data(i).enter().append("text").attr("dy",(function(e){return"showOn"===e.type?-5:5})).style("font-size",f).style("fill","black").style("font-weight","bold").style("text-anchor","middle").append("textPath").style("cursor","pointer").attr("href",(function(e,t){var n=d[t];return n>90&&n<=270?"#label-path-2":"#label-path-1"})).attr("startOffset",(function(e,t){var n=o[t],a=d[t],i=(n.startAngle+n.endAngle)/2/2/Math.PI*100;return a>90&&a<=270?100-i+"%":i+"%"})).text((function(e){return e.value})).on("click",(function(e){"delete"===e.type?y(a):"showOn"===e.type?m(a):u(a),l["c"].stopPropagation()}),!0),!1===n&&l["k"](".menu-circle").remove()}function h(e,t,n){var a=t.name;if(n){var i=a.length;if(i<=3)e.append("tspan").attr("x",0).attr("y",0).text(a);else{var s=a.substring(0,3),r=a.substring(3,7),o=a.substring(7,i),l=-22,d=8,c=34;i<=9?(l+=10,d+=10):o=a.substring(7,9)+"...",e.text(""),e.append("tspan").attr("x",0).attr("y",l).text((function(){return s})),e.append("tspan").attr("x",0).attr("y",d).text((function(){return r})),e.append("tspan").attr("x",0).attr("y",c-7).text((function(){return o}))}}else e.append("tspan").attr("x",0).attr("y",0).style("font-size",12).style("stroke","#333").text(t.name)}function v(e){l["c"].active||a.alphaTarget(.8).restart(),e.fx=e.x,e.fy=e.y}function b(e){e.fx=l["c"].x,e.fy=l["c"].y}function _(e){l["c"].active||a.alphaTarget(0),e.fx=null,e.fy=null}e.$nextTick((function(){var t={code:0,message:"",data:{id:"83c8aeb69c1011eb892ad31672d12132",name:"骨筋膜室综合症",semantic_type:"Disease",labels:["Concept","Disease"],properties:{scenes:"allinmd",status:1,lastModified:1618293198,releaseDate:1618293198}}},n=t.data;e.nodes.push(n),c.update({nodes:e.nodes,links:e.links})}))}}},p=c,u=(n("eda0"),n("2877")),f=Object(u["a"])(p,r,o,!1,null,null,null),m=f.exports,y={name:"App",components:{D3:m}},g=y,h=Object(u["a"])(g,i,s,!1,null,null,null),v=h.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(v)}}).$mount("#app")},"5dfc":function(e,t,n){},eda0:function(e,t,n){"use strict";n("5dfc")}});